<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Hoja de Vida del Usuario</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 0;
            }
            .page {
                width: 210mm;
                margin: 0 auto;
                padding: 15mm;
                box-sizing: border-box;
                background-color: #fff;
                border: 1px solid #000;
            }
            .header {
                text-align: center;
                margin-bottom: 20px;
            }
            .header img {
                width: 100px;
            }
            .header h3 {
                margin: 10px 0;
                color: #019BE2;
            }
            .section-title {
                font-size: 12pt;
                text-transform: uppercase;
                background-color: #019BE2;
                color: white;
                padding: 5px;
                margin-top: 15px;
            }
            .data-table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 10px;
            }
            .data-table th, .data-table td {
                border: 1px solid #000;
                padding: 8px;
                font-size: 10pt;
                text-align: left;
            }
            .data-table th {
                background-color: #f0f0f0;
                font-weight: bold;
                width: 25%;
            }
            .signature {
                margin-top: 20px;
                font-size: 10pt;
            }
            .signature div {
                display: inline-block;
                width: 200px;
                text-align: center;
            }
            .signature div span {
                display: block;
                border-top: 1px solid #000;
                margin-top: 30px;
            }
        </style>
    </head>
    <body>
        <div class="page" id="content">
            <!-- Encabezado -->
            <div class="header">
                <img src="/img/LogoVitamed-06.png" />
                <h3>FORMATO ÚNICO HOJA DE VIDA</h3>
                <p>ID EPS: ${hojaVida.idEps} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; REF: ${hojaVida.ref} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Fecha: ${hojaVida.fecha}</p>
            </div>

            <!-- Datos Personales -->
            <div class="section-title">Datos Personales</div>
            <table class="data-table">
                <tr>
                    <th>Apellidos</th><td colspan="3">${hojaVida.apellidoUsuario}</td>
                </tr>
                <tr>
                    <th>Nombres</th><td colspan="3">${hojaVida.nombreUsuario}</td>
                </tr>
                <tr>
                    <th>Número de Documento</th><td>${hojaVida.num_documento}</td>
                    <th>Tipo de Documento</th><td>${hojaVida.tipo_documento}</td>
                </tr>
                <tr>
                    <th>Sexo</th><td>${hojaVida.sexo}</td>
                    <th>Fecha de Nacimiento</th><td>${hojaVida.fecha_nacimiento}</td>
                </tr>
                <tr>
                    <th>Lugar de Nacimiento</th><td>${hojaVida.lugar_nacimiento}</td>
                    <th>Nacionalidad</th><td>${hojaVida.nacionalidad}</td>
                </tr>
                <tr>
                    <th>Estado del Usuario</th><td colspan="3">${hojaVida.estado_usuario}</td>
                </tr>
            </table>

            <!-- Información de Contacto -->
            <div class="section-title">Información de Contacto</div>
            <table class="data-table">
                <tr>
                    <th>Teléfono</th><td colspan="3">${hojaVida.telefonoUsuario}</td>
                </tr>
                <tr>
                    <th>Correo Electrónico</th><td colspan="3">${hojaVida.email}</td>
                </tr>
            </table>

            <!-- Dirección de Residencia -->
            <div class="section-title">Dirección de Residencia</div>
            <table class="data-table">
                <tr>
                    <th>Departamento</th><td>${hojaVida.direccion}</td>
                </tr>
            </table>

            <!-- Datos de Contacto de Emergencia -->
            <div class="section-title">Datos de Contacto de Emergencia</div>
            <table class="data-table">
                <tr>
                    <th>Nombres</th><td colspan="3">${hojaVida.contacto_emergencia_nombre}</td>
                </tr>
                <tr>
                    <th>Parentesco</th><td>${hojaVida.contacto_emergencia_parentesco}</td>
                    <th>Teléfono</th><td>${hojaVida.contacto_emergencia_telefono}</td>
                </tr>
                <tr>
                    <th>Correo Electrónico</th><td colspan="3">${hojaVida.contacto_emergencia_correo}</td>
                </tr>
            </table>

            <!-- Información Administrativa -->
            <div class="section-title">Información Administrativa</div>
            <table class="data-table">
                <tr>
                    <th>ID de Empleado</th><td>${hojaVida.id_empleado}</td>
                    <th>Nombre Completo</th><td>${hojaVida.nombre_completo}</td>
                </tr>
                <tr>
                    <th>Cargo</th><td>${hojaVida.cargo}</td>
                    <th>Fecha de Ingreso</th><td>${hojaVida.fecha_ingreso}</td>
                </tr>
                <tr>
                    <th>Tipo de Contrato</th><td>${hojaVida.tipo_contrato}</td>
                    <th>Salario Básico</th><td>${hojaVida.salarioBasico}</td>
                </tr>
                <tr>
                    <th>Bonificaciones</th><td>${hojaVida.bonificaciones}</td>
                    <th>Deducciones</th><td>${hojaVida.deducciones}</td>
                </tr>
                <tr>
                    <th>Salario Neto</th><td>${hojaVida.salario_neto}</td>
                    <th>Fecha de Pago</th><td>${hojaVida.fecha_pago}</td>
                </tr>
                <tr>
                    <th>Método de Pago</th><td>${hojaVida.metodo_pago}</td>
                    <th>Vacaciones Pendientes</th><td>${hojaVida.vacaciones_pendientes}</td>
                </tr>
                <tr>
                    <th>Días de Incapacidad</th><td>${hojaVida.dias_incapacidad}</td>
                    <th>Historial de Pagos</th><td>${hojaVida.historial_pagos}</td>
                </tr>
                <tr>
                    <th>Autorizaciones Especiales</th><td colspan="3">${hojaVida.autorizaciones_especiales}</td>
                </tr>
                <tr>
                    <th>Fecha de Terminación</th><td>${hojaVida.fecha_terminacion}</td>
                    <th>Motivo de Terminación</th><td>${hojaVida.motivo_terminacion}</td>
                </tr>
                <tr>
                    <th>Observaciones</th><td colspan="3">${hojaVida.observaciones}</td>
                </tr>
            </table>

            <!-- Firma -->
            <div class="signature" style="margin-top: 100px;">
                <div>
                    <span>Firma del Paciente</span>
                </div>
            </div>
        </div>

    <script>
        // Función para buscar hoja de vida por CC o ID
        async function fetchHojaDeVida(ccOrId, type) {
            const url = `/api/hoja-vida/${ccOrId}`;
            const response = await fetch(url);
            const data = await response.json();
            if (response.ok) {
                loadHojaDeVida(data);
            } else {
                alert('No se encontraron resultados.');
            }
        }

        function loadHojaDeVida(data) {
            document.getElementById("primer_apellido").innerText = data.primer_apellido;
            document.getElementById("segundo_apellido").innerText = data.segundo_apellido;
            document.getElementById("nombres").innerText = data.nombres;
            document.getElementById("num_documento").innerText = data.num_documento;
            document.getElementById("tipo_documento").innerText = data.tipo_documento;
            document.getElementById("sexo").innerText = data.sexo;
            document.getElementById("fecha_nacimiento").innerText = data.fecha_nacimiento;
            document.getElementById("departamento").innerText = data.departamento;
            document.getElementById("municipio").innerText = data.municipio;
            document.getElementById("lugar_nacimiento").innerText = data.lugar_nacimiento;
            document.getElementById("nacionalidad").innerText = data.nacionalidad;
            document.getElementById("estado_usuario").innerText = data.estado_usuario;
            document.getElementById("telefono").innerText = data.telefono;
            document.getElementById("email").innerText = data.email;
            document.getElementById("direccion_departamento").innerText = data.direccion_departamento;
            document.getElementById("direccion_ciudad").innerText = data.direccion_ciudad;
            document.getElementById("direccion_barrio").innerText = data.direccion_barrio;
            document.getElementById("direccion_telefono").innerText = data.direccion_telefono;
            document.getElementById("emergencia_apellido1").innerText = data.emergencia_apellido1;
            document.getElementById("emergencia_apellido2").innerText = data.emergencia_apellido2;
            document.getElementById("emergencia_nombres").innerText = data.emergencia_nombres;
            document.getElementById("emergencia_parentesco").innerText = data.emergencia_parentesco;
            document.getElementById("emergencia_telefono").innerText = data.emergencia_telefono;
            document.getElementById("emergencia_email").innerText = data.emergencia_email;
            document.getElementById("id_empleado").innerText = data.id_empleado;
            document.getElementById("nombre_completo").innerText = data.nombre_completo;
            document.getElementById("cargo").innerText = data.cargo;
            document.getElementById("fecha_ingreso").innerText = data.fecha_ingreso;
            document.getElementById("tipo_contrato").innerText = data.tipo_contrato;
            document.getElementById("salario_basico").innerText = data.salario_basico;
            document.getElementById("bonificaciones").innerText = data.bonificaciones;
            document.getElementById("deducciones").innerText = data.deducciones;
            document.getElementById("salario_neto").innerText = data.salario_neto;
            document.getElementById("fecha_pago").innerText = data.fecha_pago;
            document.getElementById("metodo_pago").innerText = data.metodo_pago;
            document.getElementById("vacaciones_pendientes").innerText = data.vacaciones_pendientes;
            document.getElementById("dias_incapacidad").innerText = data.dias_incapacidad;
            document.getElementById("historial_pagos").innerText = data.historial_pagos;
            document.getElementById("autorizaciones_especiales").innerText = data.autorizaciones_especiales;
            document.getElementById("fecha_terminacion").innerText = data.fecha_terminacion;
            document.getElementById("motivo_terminacion").innerText = data.motivo_terminacion;
            document.getElementById("observaciones").innerText = data.observaciones;
        }

        function generatePDF() {
            const element = document.getElementById('content');
            html2pdf().from(element).save('hoja-de-vida.pdf');
        }
    </script>
</body>
</html>